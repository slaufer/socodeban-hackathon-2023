<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>Ha, you lose</title>
        <link rel="stylesheet" href="Ha,%20you%20lose_files/game-viewport.css">
        <script type="module">
            import Puzzles from './js/puzzles.mjs';

            const VIEWPORT_WIDTH = 1024;
            const VIEWPORT_HEIGHT = 768;

            const vp = document.querySelector('#viewport');
            vp.style.width = `${VIEWPORT_WIDTH}px`;
            vp.style.height = `${VIEWPORT_HEIGHT}px`;

            const youlose = document.querySelector('#viewport-youlose');
            youlose.style.lineHeight = `${VIEWPORT_HEIGHT}px`;

            let selected = 0;
            const opts = [
                {
                    name: "die again",
                    action: () => window.location = `displaytest.html?puzzle=${new URLSearchParams(window.location.search).get('puzzle')}`
                },
                {
                    name: "surrender",
                    action: () => window.location = 'menu.html'
                }
            ]

            const draw = () => {
                const target = document.querySelector('#viewport-youlose-inner');

                target.innerHTML = "MENU<BR>" + opts.map((opt, i) => `${selected === i ? '&gt;&nbsp;' : '&nbsp;&nbsp;'}${opt.name}`).join('<br>');
            }

            window.addEventListener('load', () => {
                window.addEventListener('keydown', (e) => {
                    const key = e.key;

                    if (key === 'ArrowUp') {
                        e.preventDefault();
                        selected = Math.abs((selected - 1) % opts.length);
                    } else if (key === 'ArrowDown') {
                        e.preventDefault();
                        selected = Math.abs((selected + 1) % opts.length);
                    } else if (key === 'Enter') {
                        e.preventDefault();
                        opts[selected].action();
                    }

                    draw();
                });

                draw();
            });
        </script>
    </head>
    <body>
        <div id="viewport" class="chaos-level-menu" style="width: 1024px; height: 768px;">
            <div id="viewport-menu">
                <div id="viewport-menu-inner">
                    <div id="viewport-menu-logo">
                        socodeban
                        <div>please help they're keeping me in the socodeban factory</div>
                    </div>
                    <div id="viewport-menu-options">
                        fuck yeah
                    </div>
                </div>
            </div>
            <div id="viewport-fx-static"></div>
            <div id="viewport-fx-testpattern"></div>
        </div>
        <pre id="test-output"></pre>
    

</body></html>